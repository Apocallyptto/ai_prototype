diff --git a/services/signal_executor.py b/services/signal_executor.py
index 1111111..2222222 100644
--- a/services/signal_executor.py
+++ b/services/signal_executor.py
@@ -79,6 +79,7 @@ from alpaca.data.historical import StockHistoricalDataClient
 from alpaca.data.requests import StockLatestTradeRequest


 LOG = logging.getLogger("signal_executor")

@@ -104,6 +105,7 @@ class Cfg:
     symbol_cooldown_seconds: int
     pick_ttl_seconds: int

+    trade_only_when_market_open: bool
+    preopen_window_seconds: int
     trading_paused: bool
     dry_run: bool


@@ -128,6 +130,8 @@ def load_cfg() -> Cfg:
         max_daily_loss_usd=_env_float("MAX_DAILY_LOSS_USD", 200.0),
         symbol_cooldown_seconds=_env_int("SYMBOL_COOLDOWN_SECONDS", 60),
         pick_ttl_seconds=_env_int("PICK_TTL_SECONDS", 120),
+        trade_only_when_market_open=_env_bool("TRADE_ONLY_WHEN_MARKET_OPEN", True),
+        preopen_window_seconds=_env_int("PREOPEN_WINDOW_SECONDS", 0),
         trading_paused=_env_bool("TRADING_PAUSED", False),  # kill switch
         dry_run=_env_bool("DRY_RUN", False),
     )

@@ -170,6 +174,34 @@ def make_data_client() -> StockHistoricalDataClient:
     return StockHistoricalDataClient(key, sec)

+
+def _market_gate_sleep_seconds(tc: TradingClient, cfg: Cfg) -> Optional[int]:
+    """
+    Returns:
+      - None  => OK to trade now
+      - int   => sleep seconds and skip this loop iteration
+    """
+    if not cfg.trade_only_when_market_open:
+        return None
+    try:
+        c = tc.get_clock()
+    except Exception as e:
+        LOG.warning("market_clock_error | err=%s", e)
+        return 60
+
+    if c.is_open:
+        return None
+
+    # allow trading shortly before open (optional)
+    try:
+        if cfg.preopen_window_seconds and c.next_open and c.timestamp:
+            secs_to_open = (c.next_open - c.timestamp).total_seconds()
+            if 0 <= secs_to_open <= cfg.preopen_window_seconds:
+                return None
+            if secs_to_open > 0:
+                return max(10, min(int(secs_to_open), 300))
+    except Exception:
+        pass
+
+    return 60
+
@@ -456,7 +488,8 @@ def main() -> None:
         "ALPACA_DEDUPE_MINUTES=%s | CANCEL_OPPOSITE_OPEN_ORDERS=%s | MAX_OPEN_POSITIONS=%s | MAX_OPEN_ORDERS=%s | DAILY_LOSS_STOP_PCT=%.1f | "
         "MAX_DAILY_LOSS_USD=%.1f | ENABLE_DAILY_RISK_GUARD=%s | SYMBOL_COOLDOWN_SECONDS=%s | PICK_TTL_SECONDS=%s | "
-        "TRADING_PAUSED=%s | DRY_RUN=%s",
+        "TRADE_ONLY_WHEN_MARKET_OPEN=%s | PREOPEN_WINDOW_SECONDS=%s | TRADING_PAUSED=%s | DRY_RUN=%s",
         cfg.min_strength, cfg.symbols, cfg.portfolio_id, cfg.poll_seconds,
         cfg.allow_short, cfg.long_only, cfg.max_notional, cfg.max_qty, cfg.max_position_qty, cfg.allow_add_to_position,
         cfg.alpaca_dedupe_minutes, cfg.cancel_opposite_open_orders, cfg.max_open_positions, cfg.max_open_orders, cfg.daily_loss_stop_pct,
-        cfg.max_daily_loss_usd, cfg.enable_daily_risk_guard, cfg.symbol_cooldown_seconds, cfg.pick_ttl_seconds,
+        cfg.max_daily_loss_usd, cfg.enable_daily_risk_guard, cfg.symbol_cooldown_seconds, cfg.pick_ttl_seconds,
+        cfg.trade_only_when_market_open, cfg.preopen_window_seconds,
         cfg.trading_paused, cfg.dry_run,
     )

@@ -468,6 +501,16 @@ def main() -> None:
     while True:
         if cfg.trading_paused:
             LOG.info("trading paused | TRADING_PAUSED=1")
             time.sleep(cfg.poll_seconds)
             continue
+
+        sleep_s = _market_gate_sleep_seconds(tc, cfg)
+        if sleep_s is not None:
+            try:
+                c = tc.get_clock()
+                LOG.info("market_closed | is_open=%s ts=%s next_open=%s sleep=%ss", c.is_open, c.timestamp, c.next_open, sleep_s)
+            except Exception:
+                LOG.info("market_closed | sleep=%ss", sleep_s)
+            time.sleep(sleep_s)
+            continue
